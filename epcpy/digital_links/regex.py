# Character sets
DIGIT = "\d"
BOOLEAN = "(0|1)"
UPPERALPHA = "(%(4[1-9A-F]|5[0-9A]))"
LOWERALPHA = "(%(6[1-9A-F]|7[0-9A]))"
ALPHA = f"({UPPERALPHA}|{LOWERALPHA})"
HEXDIG = f"({DIGIT}|[A-F])"
DOUBLEQUOTE = '"'
GEN_DELIMS = "(:|\/|\?|#|\[|\]|@)"
SUB_DELIMS = "(!|\$|&|'|\(|\)|\*|\+|,|;|=)"
SUB_DELIMS_WITHOUT_EQUALS = "(!|\$|&|'|\(|\)|\*|\+|,|;)"
UNRESERVED = f"({ALPHA}|{DIGIT}|-|\.|_|~)"
RESERVED = f"({GEN_DELIMS}|{SUB_DELIMS})"
PCT_ENCODED = f"(%{HEXDIG}{HEXDIG})"
EVERYTHING_EXCEPT_DIGITS_AND_EQUALS = (
    f"({UNRESERVED}|{PCT_ENCODED}|{SUB_DELIMS_WITHOUT_EQUALS}" f"|:|@||\/|\?)"
)

OCTOTHORPE = "(%23)"
FORWARDSLASH = "(%2F)"
PERCENT = "(%25)"
AMPERSAND = "(%26)"
PLUS = "(%2B)"
COMMA = "(%2C)"
EXCLAMATION = "(%21)"
LEFTBRACKET = "(%28)"
RIGHTBRACKET = "(%29)"
ASTERISK = "(%2A)"
APOSTROPHE = "(%27)"
COLON = "(%3A)"
SEMICOLON = "(%3B)"
LEFTANGLEBRACKET = "(%3C)"
EQUALS = "(%3D)"
RIGHTANGLEBRACKET = "(3E)"
QUESTIONMARK = "(%3F)"

XSYMBOL = (
    f"({DOUBLEQUOTE}|-|\.|_|{EXCLAMATION}|{PERCENT}"
    f"|{AMPERSAND}|{PLUS}|{COMMA}|{FORWARDSLASH}|{ASTERISK}"
    f"|{LEFTBRACKET}|{RIGHTBRACKET}|{APOSTROPHE}|{SEMICOLON}"
    f"|{COLON}|{LEFTANGLEBRACKET}|{RIGHTANGLEBRACKET}|{EQUALS}"
    f"|{QUESTIONMARK})"
)
YSYMBOL = f"(-|{OCTOTHORPE}|{FORWARDSLASH})"
XCHAR = f"({DIGIT}|{UPPERALPHA}|{LOWERALPHA}|{XSYMBOL})"
YCHAR = f"({DIGIT}|{UPPERALPHA}|{YSYMBOL})"

# Primary identification keys
GTIN_CODE = "01"
ITIP_CODE = "8006"
GMN_CODE = "8013"
CPID_CODE = "8010"
GLN_CODE = "414"
PGLN_CODE = "417"
GSRNP_CODE = "8017"
GSRN_CODE = "8018"
GCN_CODE = "255"
SSCC_CODE = "00"
GDTI_CODE = "253"
GINC_CODE = "401"
GSIN_CODE = "402"
GRAI_CODE = "8003"
GIAI_CODE = "8004"

# Key qualifiers
CPV_CODE = "22"
LOT_CODE = "10"
SER_CODE = "21"
CPSN_CODE = "8011"
GLNX_CODE = "254"
REFNO_CODE = "8020"
SRIN_CODE = "8019"
TPX_CODE = "235"
UIC_EXT_CODE = "7040"

# Primary key formats
GTIN_VALUE = f"({DIGIT}{{12,14}}|{DIGIT}{{8}})"
ITIP_VALUE = f"{DIGIT}{{14}}{DIGIT}{{2}}{DIGIT}{{2}}"
GMN_VALUE = f"{XCHAR}{{1,25}}"
CPID_VALUE = f"{YCHAR}{{1,30}}"
GLN_VALUE = f"{DIGIT}{{13}}"
PGLN_VALUE = f"{DIGIT}{{13}}"
GSRNP_VALUE = f"{DIGIT}{{18}}"
GSRN_VALUE = f"{DIGIT}{{18}}"
GCN_VALUE = f"{DIGIT}{{13}}({DIGIT}{{1,12}})?"
SSCC_VALUE = f"{DIGIT}{{18}}"
GDTI_VALUE = f"{DIGIT}{{1,13}}({XCHAR}{{1,17}})?"
GINC_VALUE = f"{XCHAR}{{1,30}}"
GSIN_VALUE = f"{DIGIT}{{17}}"
GRAI_VALUE = f"{DIGIT}{{14}}({XCHAR}{{1,16}})?"
GIAI_VALUE = f"{XCHAR}{{1,30}}"

# Key qualifier formats
CPV_VALUE = f"{XCHAR}{{1,20}}"
LOT_VALUE = f"{XCHAR}{{1,20}}"
SER_VALUE = f"{XCHAR}{{1,20}}"
CPSN_VALUE = f"{DIGIT}{{1,12}}"
GLNX_VALUE = f"{XCHAR}{{1,20}}"
REFNO_VALUE = f"{XCHAR}{{1,25}}"
SRIN_VALUE = f"{DIGIT}{{1,10}}"
TPX_VALUE = f"{XCHAR}{{1,28}}"
UIC_EXT_VALUE = f"{DIGIT}{{1}}{XCHAR}{{3}}"

# Primary identifier and value concatenation
GTIN_COMP = f"/{GTIN_CODE}/{GTIN_VALUE}"
ITIP_COMP = f"/{ITIP_CODE}/{ITIP_VALUE}"
GMN_COMP = f"/{GMN_CODE}/{GMN_VALUE}"
CPID_COMP = f"/{CPID_CODE}/{CPID_VALUE}"
GLN_COMP = f"/{GLN_CODE}/{GLN_VALUE}"
PGLN_COMP = f"/{PGLN_CODE}/{PGLN_VALUE}"
GSRNP_COMP = f"/{GSRNP_CODE}/{GSRNP_VALUE}"
GSRN_COMP = f"/{GSRN_CODE}/{GSRN_VALUE}"
GCN_COMP = f"/{GCN_CODE}/{GCN_VALUE}"
SSCC_COMP = f"/{SSCC_CODE}/{SSCC_VALUE}"
GDTI_COMP = f"/{GDTI_CODE}/{GDTI_VALUE}"
GINC_COMP = f"/{GINC_CODE}/{GINC_VALUE}"
GSIN_COMP = f"/{GSIN_CODE}/{GSIN_VALUE}"
GRAI_COMP = f"/{GRAI_CODE}/{GRAI_VALUE}"
GIAI_COMP = f"/{GIAI_CODE}/{GIAI_VALUE}"

# Key qualifier concatenations
CPV_COMP = f"/{CPV_CODE}/{CPV_VALUE}"
LOT_COMP = f"/{LOT_CODE}/{LOT_VALUE}"
SER_COMP = f"/{SER_CODE}/{SER_VALUE}"
CPSN_COMP = f"/{CPSN_CODE}/{CPSN_VALUE}"
GLNX_COMP = f"/{GLNX_CODE}/{GLNX_VALUE}"
REFNO_COMP = f"/{REFNO_CODE}/{REFNO_VALUE}"
SRIN_COMP = f"/{SRIN_CODE}/{SRIN_VALUE}"
TPX_COMP = f"/{TPX_CODE}/{TPX_VALUE}"
UIC_EXT_COMP = f"/{UIC_EXT_CODE}/{UIC_EXT_VALUE}"

# Path element order
GTIN_PATH = f"{GTIN_COMP}({CPV_COMP})?({LOT_COMP})?({SER_COMP})?"
ITIP_PATH = f"{ITIP_COMP}({CPV_COMP})?({LOT_COMP})?({SER_COMP})?"
GMN_PATH = f"{GMN_COMP}"
CPID_PATH = f"{CPID_COMP}({CPSN_COMP})?"
GLN_PATH = f"{GLN_COMP}({GLNX_COMP})?"
PGLN_PATH = f"{PGLN_COMP}"
GSRNP_PATH = f"{GSRNP_COMP}({SRIN_COMP})?"
GSRN_PATH = f"{GSRN_COMP}({SRIN_COMP})?"
GCN_PATH = f"{GCN_COMP}"
SSCC_PATH = f"{SSCC_COMP}"
GDTI_PATH = f"{GDTI_COMP}"
GINC_PATH = f"{GINC_COMP}"
GSIN_PATH = f"{GSIN_COMP}"
GRAI_PATH = f"{GRAI_COMP}"
GIAI_PATH = f"{GIAI_COMP}"
UPUI_PATH = f"{GTIN_COMP}{TPX_COMP}"
EOID_PATH = f"{PGLN_COMP}{UIC_EXT_COMP}"
FID_PATH = f"{GLN_COMP}{UIC_EXT_COMP}"
MID_PATH = f"{GIAI_COMP}{UIC_EXT_COMP}"

GS1PATH = (
    f"(({GTIN_PATH})|({ITIP_PATH})|({GMN_PATH})|({CPID_PATH})|({GLN_PATH})"
    f"|({PGLN_PATH})|({GSRNP_PATH})|({GSRN_PATH})|({GCN_PATH})|({SSCC_PATH})"
    f"|({GDTI_PATH})|({GINC_PATH})|({GSIN_PATH})|({GRAI_PATH})|({GIAI_PATH})"
    f"|({UPUI_PATH})|({EOID_PATH})|({FID_PATH})|({MID_PATH}))"
)

# Data attributes
NET_WEIGHT_VMTI_CODE = (
    "(3100|3101|3102|3103|3104|3105"
    "|3200|3201|3202|3203|3204|3205"
    "|3560|3561|3562|3563|3564|3565"
    "|3570|3571|3572|3573|3574|3575)"
)
NET_WEIGHT_VMTI_VALUE = f"{DIGIT}{{6}}"
NET_WEIGHT_VMTI_PARAMETER = f"{NET_WEIGHT_VMTI_CODE}={NET_WEIGHT_VMTI_VALUE}"

LENGTH_VMTI_CODE = (
    "(3110|3111|3112|3113|3114|3115"
    "|3210|3211|3212|3213|3214|3215"
    "|3220|3221|3222|3223|3224|3225"
    "|3230|3231|3232|3233|3234|3235)"
)
LENGTH_VMTI_VALUE = f"{DIGIT}{{6}}"
LENGTH_VMTI_PARAMETER = f"{LENGTH_VMTI_CODE}={LENGTH_VMTI_VALUE}"

WIDTH_VMTI_CODE = (
    "(3120|3121|3122|3123|3124|3125"
    "|3240|3241|3242|3243|3244|3245"
    "|3250|3251|3252|3253|3254|3255"
    "|3260|3261|3262|3263|3264|3265)"
)
WIDTH_VMTI_VALUE = f"{DIGIT}{{6}}"
WIDTH_VMTI_PARAMETER = f"{WIDTH_VMTI_CODE}={WIDTH_VMTI_VALUE}"

DEPTH_VMTI_CODE = (
    "(3130|3131|3132|3133|3134|3135"
    "|3270|3271|3272|3273|3274|3275"
    "|3280|3281|3282|3283|3284|3285"
    "|3290|3291|3292|3293|3294|3295)"
)
DEPTH_VMTI_VALUE = f"{DIGIT}{{6}}"
DEPTH_VMTI_PARAMETER = f"{DEPTH_VMTI_CODE}={DEPTH_VMTI_VALUE}"

AREA_VMTI_CODE = (
    "(3140|3141|3142|3143|3144|3145"
    "|3500|3501|3502|3503|3504|3505"
    "|3510|3511|3512|3513|3514|3515"
    "|3520|3521|3522|3523|3524|3525)"
)
AREA_VMTI_VALUE = f"{DIGIT}{{6}}"
AREA_VMTI_PARAMETER = f"{AREA_VMTI_CODE}={AREA_VMTI_VALUE}"

NET_VOLUME_VMTI_CODE = (
    "(3150|3151|3152|3153|3154|3155"
    "|3160|3161|3162|3163|3164|3165"
    "|3600|3601|3602|3603|3604|3605"
    "|3610|3611|3612|3613|3614|3615"
    "|3640|3641|3642|3643|3644|3645"
    "|3650|3651|3652|3653|3654|3655"
    "|3660|3661|3662|3663|3664|3665)"
)
NET_VOLUME_VMTI_VALUE = f"{DIGIT}{{6}}"
NET_VOLUME_VMTI_PARAMETER = f"{NET_VOLUME_VMTI_CODE}={NET_VOLUME_VMTI_VALUE}"

MASS_PER_UNIT_AREA_VMTI_CODE = "(3370|3371|3372|3373|3374" "|3375)"
MASS_PER_UNIT_AREA_VMTI_VALUE = f"{DIGIT}{{6}}"
MASS_PER_UNIT_AREA_VMTI_PARAMETER = (
    f"{MASS_PER_UNIT_AREA_VMTI_CODE}={MASS_PER_UNIT_AREA_VMTI_VALUE}"
)

GROSS_WEIGHT_CODE = "(3300|3301|3302|3303|3304|3305" "|3400|3401|3402|3403|3404|3405)"
GROSS_WEIGHT_VALUE = f"{DIGIT}{{6}}"
GROSS_WEIGHT_PARAMETER = f"{GROSS_WEIGHT_CODE}={GROSS_WEIGHT_VALUE}"

LOGISTIC_LENGTH_CODE = (
    "(3310|3311|3312|3313|3314|3315"
    "|3410|3411|3412|3413|3414|3415"
    "|3420|3421|3422|3423|3424|3425"
    "|3430|3431|3432|3433|3434|3435)"
)
LOGISTIC_LENGTH_VALUE = f"{DIGIT}{{6}}"
LOGISTIC_LENGTH_PARAMETER = f"{LOGISTIC_LENGTH_CODE}={LOGISTIC_LENGTH_VALUE}"

LOGISTIC_WIDTH_CODE = (
    "(3320|3321|3322|3323|3324|3325"
    "|3440|3441|3442|3443|3444|3445"
    "|3450|3451|3452|3453|3454|3455"
    "|3460|3461|3462|3463|3464|3465)"
)
LOGISTIC_WIDTH_VALUE = f"{DIGIT}{{6}}"
LOGISTIC_WIDTH_PARAMETER = f"{LOGISTIC_WIDTH_CODE}={LOGISTIC_WIDTH_VALUE}"

LOGISTIC_DEPTH_CODE = (
    "(3330|3331|3332|3333|3334|3335"
    "|3470|3471|3472|3473|3474|3475"
    "|3480|3481|3482|3483|3484|3485"
    "|3490|3491|3492|3493|3494|3495)"
)
LOGISTIC_DEPTH_VALUE = f"{DIGIT}{{6}}"
LOGISTIC_DEPTH_PARAMETER = f"{LOGISTIC_DEPTH_CODE}={LOGISTIC_DEPTH_VALUE}"

LOGISTIC_AREA_CODE = (
    "(3340|3341|3342|3343|3344|3345"
    "|3530|3531|3532|3533|3534|3535"
    "|3540|3541|3542|3543|3544|3545"
    "|3550|3551|3552|3553|3554|3555)"
)
LOGISTIC_AREA_VALUE = f"{DIGIT}{{6}}"
LOGISTIC_AREA_PARAMETER = f"{LOGISTIC_AREA_CODE}={LOGISTIC_AREA_VALUE}"

LOGISTIC_VOLUME_CODE = (
    "(3350|3351|3352|3353|3354|3355"
    "|3360|3361|3362|3363|3364|3365"
    "|3620|3621|3622|3623|3624|3625"
    "|3630|3631|3632|3633|3634|3635"
    "|3670|3671|3672|3673|3674|3675"
    "|3680|3681|3682|3683|3684|3685"
    "|3690|3691|3692|3693|3694|3695)"
)
LOGISTIC_VOLUME_VALUE = f"{DIGIT}{{6}}"
LOGISTIC_VOLUME_PARAMETER = f"{LOGISTIC_VOLUME_CODE}={LOGISTIC_VOLUME_VALUE}"

PROCESSOR_CODE = "(7030|7031|7032|7033|7034|7035" "|7036|7037|7038|7039)"
PROCESSOR_VALUE = f"{DIGIT}{{3}}{XCHAR}{{1,27}}"
PROCESSOR_PARAMETER = f"{PROCESSOR_CODE}={PROCESSOR_VALUE}"

CONTENT_PARAMETER = f"02={DIGIT}{{14}}"
PROD_DATE_PARAMETER = f"11={DIGIT}{{6}}"
DUE_DATE_PARAMETER = f"12={DIGIT}{{6}}"
PACK_DATE_PARAMETER = f"13={DIGIT}{{6}}"
BEST_BEFORE_DATE_PARAMETER = f"15={DIGIT}{{6}}"
SELL_BY_DATE_PARAMETER = f"16={DIGIT}{{6}}"
FIRST_FREEZE_DATE_PARAMETER = f"7006={DIGIT}{{6}}"
HARVEST_DATE_PARAMETER = f"7007={DIGIT}{{6}}({DIGIT}{{6}})?"
PRICE_PER_UNIT_PARAMETER = f"8005={DIGIT}{{6}}"
VARIANT_PARAMETER = f"20={DIGIT}{{6}}"
VAR_COUNT_PARAMETER = f"30={DIGIT}{{1,8}}"
COUNT_PARAMETER = f"37={DIGIT}{{1,8}}"
MUTUAL_PARAMETER = f"90={XCHAR}{{1,30}}"
ADDITIONAL_ID_PARAMETER = f"240={XCHAR}{{1,30}}"
CUST_PART_NO_PARAMETER = f"241={XCHAR}{{1,30}}"
MTO_VARIANT_PARAMETER = f"242={DIGIT}{{1,6}}"
PCN_PARAMETER = f"243={XCHAR}{{1,20}}"
SECONDARY_SERIAL_PARAMETER = f"250={XCHAR}{{1,30}}"
REF_TO_SOURCE_PARAMETER = f"251={XCHAR}{{1,30}}"

AMOUNT_CODE = f"(3900|3901|3902|3903|3904|3905)"
AMOUNT_VALUE = f"{DIGIT}{{1,15}}"
AMOUNT_PARAMETER = f"{AMOUNT_CODE}={AMOUNT_VALUE}"

AMOUNT_ISO_CODE = f"(3910|3911|3912|3913|3914|3915)"
AMOUNT_ISO_VALUE = f"{DIGIT}{{3}}{DIGIT}{{1,15}}"
AMOUNT_ISO_PARAMETER = f"{AMOUNT_ISO_CODE}={AMOUNT_ISO_VALUE}"

PRICE_CODE = f"(3920|3921|3922|3923|3924|3925)"
PRICE_VALUE = f"{DIGIT}{{1,15}}"
PRICE_PARAMETER = f"{PRICE_CODE}={PRICE_VALUE}"

PRICE_ISO_CODE = f"(3930|3931|3932|3933|3934|3935)"
PRICE_ISO_VALUE = f"{DIGIT}{{3}}{DIGIT}{{1,15}}"
PRICE_ISO_PARAMETER = f"{PRICE_ISO_CODE}={PRICE_ISO_VALUE}"

PERCENT_OFF_CODE = f"(3940|3941|3942|3943|3944|3945)"
PERCENT_OFF_VALUE = f"{DIGIT}{{4}}"
PERCENT_OFF_PARAMETER = f"{PERCENT_OFF_CODE}={PERCENT_OFF_VALUE}"

ORDER_NUMBER_PARAMETER = f"400={XCHAR}{{1,30}}"
ROUTE_PARAMETER = f"403={XCHAR}{{1,30}}"
SHIP_TO_LOC_PARAMETER = f"410={DIGIT}{{13}}"

BILL_TO_PARAMETER = f"411={DIGIT}{{13}}"
PURCHASE_FROM_PARAMETER = f"412={DIGIT}{{13}}"
SHIP_FOR_LOC_PARAMETER = f"413={DIGIT}{{13}}"
PAY_TO_PARAMETER = f"415={DIGIT}{{13}}"
PROD_SERV_LOC_PARAMETER = f"416={DIGIT}{{13}}"
SHIP_TO_POST_PARAMETER = f"420={XCHAR}{{1,20}}"
SHIP_TO_POST_ISO_PARAMETER = f"421={DIGIT}{{3}}{XCHAR}{{1,9}}"
ORIGIN_PARAMETER = f"422={DIGIT}{{3}}"
COUNTRY_PROCESS_PARAMETER = f"424={DIGIT}{{3}}"
COUNTRY_FULL_PROCESS_PARAMETER = f"426={DIGIT}{{3}}"
COUNTRY_INITIAL_PROCESS_PARAMETER = f"423={DIGIT}{{3}}{DIGIT}{{1,12}}"
COUNTRY_DISASSEMBLY_PARAMETER = f"425={DIGIT}{{3}}{DIGIT}{{1,12}}"
ORIGIN_SUBDIVISION_PARAMETER = f"427={XCHAR}{{1,3}}"
NHRN_PZN_PARAMETER = f"710={XCHAR}{{1,20}}"
NHRN_CIP_PARAMETER = f"711={XCHAR}{{1,20}}"
NHRN_CN_PARAMETER = f"712={XCHAR}{{1,20}}"
NHRN_DRN_PARAMETER = f"713={XCHAR}{{1,20}}"
NHRN_AIM_PARAMETER = f"714={XCHAR}{{1,20}}"
NHRN_US_FDA_PARAMETER = f"715={XCHAR}{{1,20}}"
NSN_PARAMETER = f"7001={DIGIT}{{13}}"
MEAT_CUT_PARAMETER = f"7002={XCHAR}{{1,30}}"
ACTIVE_POTENCY_PARAMETER = f"7004={DIGIT}{{1,4}}"
CATCH_AREA_PARAMETER = f"7005={XCHAR}{{1,12}}"
AQUATIC_SPECIES_PARAMETER = f"7008={XCHAR}{{1,3}}"
FISHING_GEAR_TYPE_PARAMETER = f"7009={XCHAR}{{1,10}}"
PROD_METHOD_PARAMETER = f"7010={XCHAR}{{1,2}}"
REFURB_LOT_PARAMETER = f"7020={XCHAR}{{1,20}}"
FUNC_STAT_PARAMETER = f"7021={XCHAR}{{1,20}}"
REV_STAT_PARAMETER = f"7022={XCHAR}{{1,20}}"
GIAI_ASSEMBLY_PARAMETER = f"7023={XCHAR}{{1,30}}"

CERTIFICATION_REF_CODE = "(7230|7231|7232|7233|7234|7235|7236|7237|7238|7239)"
CERTIFICATION_REF_VALUE = f"{XCHAR}{{2}}{XCHAR}{{1,28}}"
CERTIFICATION_REF_PARAMETER = f"{CERTIFICATION_REF_CODE}={CERTIFICATION_REF_VALUE}"

DIMENSIONS_PARAMETER = f"8001={DIGIT}{{14}}"
CMT_NO_PARAMETER = f"8002={XCHAR}{{1,20}}"
IBAN_PARAMETER = f"8007={XCHAR}{{1,34}}"
PROD_TIME_PARAMETER = f"8008={DIGIT}{{8}}({DIGIT}{{2}})?({DIGIT}{{2}})?"
OPTICAL_SENSOR_PARAMETER = f"8009={XCHAR}{{1,50}}"
VERSION_PARAMETER = f"8012={XCHAR}{{1,20}}"
REF_NO_PARAMETER = f"8020={XCHAR}{{1,25}}"
ITIP_CONTENT_PARAMETER = f"8026={DIGIT}{{14}}{DIGIT}{{2}}{DIGIT}{{2}}"
COUPON_IDNA_PARAMETER = f"8110={XCHAR}{{1,70}}"
POINTS_PARAMETER = f"8111={DIGIT}{{4}}"
PAPERLESS_COUPON_IDNA_PARAMETER = f"8112={XCHAR}{{1,70}}"
SHIP_TO_COMP_PARAMETER = f"4300={XCHAR}{{1,35}}"
SHIP_TO_NAME_PARAMETER = f"4301={XCHAR}{{1,35}}"
SHIP_TO_ADD1_PARAMETER = f"4302={XCHAR}{{1,70}}"
SHIP_TO_ADD2_PARAMETER = f"4303={XCHAR}{{1,70}}"
SHIP_TO_SUB_PARAMETER = f"4304={XCHAR}{{1,70}}"
SHIP_TO_LOCALITY_PARAMETER = f"4305={XCHAR}{{1,70}}"
SHIP_TO_REG_PARAMETER = f"4306={XCHAR}{{1,70}}"
SHIP_TO_COUNTRY_PARAMETER = f"4307={XCHAR}{{2}}"
SHIP_TO_PHONE_PARAMETER = f"4308={XCHAR}{{1,30}}"
RTN_TO_COMP_PARAMETER = f"4310={XCHAR}{{1,35}}"
RTN_TO_NAME_PARAMETER = f"4311={XCHAR}{{1,35}}"
RTN_TO_ADD1_PARAMETER = f"4312={XCHAR}{{1,70}}"
RTN_TO_ADD2_PARAMETER = f"4313={XCHAR}{{1,70}}"
RTN_TO_SUB_PARAMETER = f"4314={XCHAR}{{1,70}}"
RTN_TO_LOC_PARAMETER = f"4315={XCHAR}{{1,70}}"
RTN_TO_REG_PARAMETER = f"4316={XCHAR}{{1,70}}"

RTN_TO_COUNTRY_PARAMETER = f"4317={XCHAR}{{2}}"
RTN_TO_POST_PARAMETER = f"4318={XCHAR}{{1,20}}"
RTN_TO_PHONE_PARAMETER = f"4319={XCHAR}{{1,30}}"
SRV_DESCRIPTION_PARAMETER = f"4320={XCHAR}{{1,35}}"
DANGEROUS_GOODS_PARAMETER = f"4321={BOOLEAN}"
AUTH_TO_LEAVE_PARAMETER = f"4322={BOOLEAN}"
SIG_REQUIRED_PARAMETER = f"4323={BOOLEAN}"
NOT_BEFORE_DEL_DATE_PARAMETER = f"4324={DIGIT}{{10}}"
NOT_AFTER_DEL_DATE_PARAMETER = f"4325={DIGIT}{{10}}"
RELEASE_DATE_PARAMETER = f"4326={DIGIT}{{6}}"

AMOUNT_PAY_PER_UNIT_CODE = f"(3950|3951|3952|3953)"
AMOUNT_PAY_PER_UNIT_VALUE = f"{DIGIT}{{6}}"
AMOUNT_PAY_PER_UNIT_PARAMETER = (
    f"{AMOUNT_PAY_PER_UNIT_CODE}={AMOUNT_PAY_PER_UNIT_VALUE}"
)

GTIN_PARAMETER = f"01={GTIN_VALUE}"
ITIP_PARAMETER = f"8006={ITIP_VALUE}"
GMN_PARAMETER = f"8013={GMN_VALUE}"
CPID_PARAMETER = f"8010={CPID_VALUE}"
GLN_PARAMETER = f"414={GLN_VALUE}"
PGLN_PARAMETER = f"417={PGLN_VALUE}"
GSRNP_PARAMETER = f"8017={GSRNP_VALUE}"
GSRN_PARAMETER = f"8018={GSRN_VALUE}"
GCN_PARAMETER = f"255={GCN_VALUE}"
SSCC_PARAMETER = f"00={SSCC_VALUE}"
GDTI_PARAMETER = f"253={GDTI_VALUE}"
GINC_PARAMETER = f"401={GINC_VALUE}"
GSIN_PARAMETER = f"402={GSIN_VALUE}"
GRAI_PARAMETER = f"8003={GRAI_VALUE}"
GIAI_PARAMETER = f"8004={GIAI_VALUE}"

INTERNAL_CODE = "(91|92|93|94|95|96|97|98|99)"
INTERNAL_VALUE = f"{XCHAR}{{1,90}}"
INTERNAL_PARAMETER = f"{INTERNAL_CODE}={INTERNAL_VALUE}"

LOT_PARAMETER = f"{LOT_CODE}={LOT_VALUE}"

EXPIRY_DATE_CODE = "(17|exp)"
EXPIRY_DATE_VALUE = f"{DIGIT}{{6}}"
EXPIRY_DATE_PARAMETER = f"{EXPIRY_DATE_CODE}={EXPIRY_DATE_VALUE}"

EXPIRY_TIME_CODE = "(7003|expdt)"
EXPIRY_TIME_VALUE = f"{DIGIT}{{10}}"
EXPIRY_TIME_PARAMETER = f"{EXPIRY_TIME_CODE}={EXPIRY_TIME_VALUE}"

# Extension mechanism and reserved keywords
# TODO: implement exceptions as mentioned in paragraph 4.10.1 of release 1.2.1 of the GS1 Digital Link Standard
EXTENSION_KEY = f"({DIGIT}*{EVERYTHING_EXCEPT_DIGITS_AND_EQUALS}({DIGIT}|{EVERYTHING_EXCEPT_DIGITS_AND_EQUALS})*)"
EXTENSION_VALUE = f"({DIGIT}|{EVERYTHING_EXCEPT_DIGITS_AND_EQUALS}|=)*"
EXTENSION_PARAMETER = f"{EXTENSION_KEY}={EXTENSION_VALUE}"

# Query string
QUERY_STRING_PARAM = (
    f"({NET_WEIGHT_VMTI_PARAMETER}|{LENGTH_VMTI_PARAMETER}|{WIDTH_VMTI_PARAMETER}"
    f"|{DEPTH_VMTI_PARAMETER}|{AREA_VMTI_PARAMETER}|{NET_VOLUME_VMTI_PARAMETER}"
    f"|{MASS_PER_UNIT_AREA_VMTI_PARAMETER}|{GROSS_WEIGHT_PARAMETER}"
    f"|{LOGISTIC_LENGTH_PARAMETER}|{LOGISTIC_WIDTH_PARAMETER}|{LOGISTIC_DEPTH_PARAMETER}"
    f"|{LOGISTIC_AREA_PARAMETER}|{LOGISTIC_VOLUME_PARAMETER}|{PROCESSOR_PARAMETER}"
    f"|{LOT_PARAMETER}|{EXPIRY_DATE_PARAMETER}|{EXPIRY_TIME_PARAMETER}|{CONTENT_PARAMETER}"
    f"|{PROD_DATE_PARAMETER}|{DUE_DATE_PARAMETER}|{PACK_DATE_PARAMETER}"
    f"|{BEST_BEFORE_DATE_PARAMETER}|{SELL_BY_DATE_PARAMETER}|{FIRST_FREEZE_DATE_PARAMETER}"
    f"|{HARVEST_DATE_PARAMETER}|{PRICE_PER_UNIT_PARAMETER}|{VARIANT_PARAMETER}"
    f"|{VAR_COUNT_PARAMETER}|{COUNT_PARAMETER}|{AMOUNT_PAY_PER_UNIT_PARAMETER}"
    f"|{ADDITIONAL_ID_PARAMETER}|{CUST_PART_NO_PARAMETER}|{MTO_VARIANT_PARAMETER}"
    f"|{PCN_PARAMETER}|{SECONDARY_SERIAL_PARAMETER}|{REF_TO_SOURCE_PARAMETER}"
    f"|{AMOUNT_PARAMETER}|{AMOUNT_ISO_PARAMETER}|{PRICE_PARAMETER}|{PRICE_ISO_PARAMETER}"
    f"|{PERCENT_OFF_PARAMETER}|{ORDER_NUMBER_PARAMETER}|{ROUTE_PARAMETER}"
    f"|{SHIP_TO_LOC_PARAMETER}|{BILL_TO_PARAMETER}|{PURCHASE_FROM_PARAMETER}"
    f"|{SHIP_FOR_LOC_PARAMETER}|{PROD_SERV_LOC_PARAMETER}|{SHIP_TO_POST_PARAMETER}"
    f"|{SHIP_TO_POST_ISO_PARAMETER}|{ORIGIN_PARAMETER}|{COUNTRY_PROCESS_PARAMETER}"
    f"|{COUNTRY_FULL_PROCESS_PARAMETER}|{COUNTRY_INITIAL_PROCESS_PARAMETER}"
    f"|{COUNTRY_DISASSEMBLY_PARAMETER}|{ORIGIN_SUBDIVISION_PARAMETER}|{NHRN_PZN_PARAMETER}"
    f"|{NHRN_CIP_PARAMETER}|{NHRN_CN_PARAMETER}|{NHRN_DRN_PARAMETER}|{NSN_PARAMETER}"
    f"|{MEAT_CUT_PARAMETER}|{ACTIVE_POTENCY_PARAMETER}|{CATCH_AREA_PARAMETER}"
    f"|{FISHING_GEAR_TYPE_PARAMETER}|{PROD_METHOD_PARAMETER}|{REFURB_LOT_PARAMETER}"
    f"|{FUNC_STAT_PARAMETER}|{REV_STAT_PARAMETER}|{GIAI_ASSEMBLY_PARAMETER}"
    f"|{DIMENSIONS_PARAMETER}|{CMT_NO_PARAMETER}|{IBAN_PARAMETER}|{PROD_TIME_PARAMETER}"
    f"|{VERSION_PARAMETER}|{REF_NO_PARAMETER}|{COUPON_IDNA_PARAMETER}|{POINTS_PARAMETER}"
    f"|{ITIP_CONTENT_PARAMETER}|{CERTIFICATION_REF_PARAMETER}|{AQUATIC_SPECIES_PARAMETER}"
    f"|{OPTICAL_SENSOR_PARAMETER}|{PAPERLESS_COUPON_IDNA_PARAMETER}|{INTERNAL_PARAMETER}"
    f"|{MUTUAL_PARAMETER}|{EXTENSION_PARAMETER}|{SHIP_TO_COMP_PARAMETER}"
    f"|{SHIP_TO_NAME_PARAMETER}|{SHIP_TO_ADD1_PARAMETER}|{SHIP_TO_ADD2_PARAMETER}"
    f"|{SHIP_TO_SUB_PARAMETER}|{SHIP_TO_LOCALITY_PARAMETER}|{SHIP_TO_REG_PARAMETER}"
    f"|{SHIP_TO_COUNTRY_PARAMETER}|{SHIP_TO_PHONE_PARAMETER}|{RTN_TO_COMP_PARAMETER}"
    f"|{RTN_TO_NAME_PARAMETER}|{RTN_TO_ADD1_PARAMETER}|{RTN_TO_ADD2_PARAMETER}"
    f"|{RTN_TO_SUB_PARAMETER}|{RTN_TO_LOC_PARAMETER}|{RTN_TO_REG_PARAMETER}"
    f"|{RTN_TO_COUNTRY_PARAMETER}|{RTN_TO_POST_PARAMETER}|{RTN_TO_PHONE_PARAMETER}"
    f"|{SRV_DESCRIPTION_PARAMETER}|{DANGEROUS_GOODS_PARAMETER}|{AUTH_TO_LEAVE_PARAMETER}"
    f"|{SIG_REQUIRED_PARAMETER}|{NOT_BEFORE_DEL_DATE_PARAMETER}|{NOT_AFTER_DEL_DATE_PARAMETER}"
    f"|{RELEASE_DATE_PARAMETER}|{GTIN_PARAMETER}|{ITIP_PARAMETER}|{GMN_PARAMETER}"
    f"|{CPID_PARAMETER}|{GLN_PARAMETER}|{PGLN_PARAMETER}|{GSRNP_PARAMETER}"
    f"|{GSRN_PARAMETER}|{GCN_PARAMETER}|{SSCC_PARAMETER}|{GDTI_PARAMETER}|{GINC_PARAMETER}"
    f"|{GSIN_PARAMETER}|{GRAI_PARAMETER}|{GIAI_PARAMETER})"
)

# GS1 Digital Link URI
SCHEME = "(http|https)"
PCHAR = f"({UNRESERVED}|{PCT_ENCODED}|{SUB_DELIMS}|:|@)"
SEGMENT = f"({PCHAR})*"
REG_NAME = f"({UNRESERVED}|{PCT_ENCODED}|{SUB_DELIMS})*"
DEC_OCTET = (
    f"({DIGIT}"
    f"|%3[1-9]{DIGIT}"
    f"|1{DIGIT}{DIGIT}"
    f"|2%3[0-4]{DIGIT}"
    f"|25%3[0-5])"
)
IPV4_ADDRESS = f"{DEC_OCTET}\.{DEC_OCTET}\.{DEC_OCTET}\.{DEC_OCTET}"

H16 = f"{HEXDIG}{{1,4}}"
LS32 = f"({H16}:{H16})"
IPV6_ADDRESS = (
    f"(({H16}:){{6}}{LS32}"
    f"|::({H16}:){{5}}{LS32}"
    f"|{H16}?::({H16}:){{4}}{LS32}"
    f"|(({H16}:){{1}}{H16})?::({H16}:){{3}}{LS32}"
    f"|(({H16}:){{2}}{H16})?::({H16}:){{2}}{LS32}"
    f"|(({H16}:){{3}}{H16})?::{H16}:{LS32}"
    f"|(({H16}:){{4}}{H16})?::{LS32}"
    f"|(({H16}:){{5}}{H16})?::{H16}"
    f"|(({H16}:){{6}}{H16})?::)"
)
IPV_FUTURE = f"(v{HEXDIG}\.({UNRESERVED}|{SUB_DELIMS}|:))"
IP_LITERAL = f"\[({IPV6_ADDRESS}|{IPV_FUTURE})\]"
HOST = f"({IP_LITERAL}|{IPV4_ADDRESS}|{REG_NAME})"
PORT = f"{DIGIT}*"
HOSTNAME = f"({HOST}(:{PORT})?)"

QUERY_STRING_DELIM = "(&|;)"
QUERY_STRING_COMP = (
    f"(\?{QUERY_STRING_PARAM}({QUERY_STRING_DELIM}{QUERY_STRING_PARAM})*)"
)
UNCOMPRESSED_GS1_WEB_URI_PATTERN = f"({GS1PATH}({QUERY_STRING_COMP})?)"
REFERENCE_GS1_WEB_URI = f"(https:\/\/id.gs1.org{UNCOMPRESSED_GS1_WEB_URI_PATTERN})"

OPTIONAL_PATH_SEGMENT = f"(\/{SEGMENT})"
CUSTOM_URI_STEM = f"({SCHEME}:\/\/{HOSTNAME}({OPTIONAL_PATH_SEGMENT})*)"
UNCOMPRESSED_CUSTOM_GS1_WEB_URI = (
    f"({CUSTOM_URI_STEM}{UNCOMPRESSED_GS1_WEB_URI_PATTERN})"
)
